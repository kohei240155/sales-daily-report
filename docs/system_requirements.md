# 営業日報システム システム要件定義書

## 目次

1. [システム概要](#システム概要)
2. [目的と背景](#目的と背景)
3. [主要機能](#主要機能)
4. [機能要件](#機能要件)
5. [非機能要件](#非機能要件)
6. [システム構成](#システム構成)
7. [ユーザー種別と権限](#ユーザー種別と権限)
8. [エンティティ定義](#エンティティ定義)
9. [制約事項](#制約事項)
10. [今後の拡張性](#今後の拡張性)

---

## システム概要

### システム名

営業日報システム (Sales Daily Report System)

### システムの概要

営業担当者が日々の営業活動を報告し、上長が確認・フィードバックできる日報管理システム。
訪問記録の管理、課題・予定の共有、上長からのコメント機能を提供する。

### 対象ユーザー

- 営業担当者（一般）
- 上長（課長、部長など）
- システム管理者

---

## 目的と背景

### 目的

1. 営業活動の可視化と共有
2. 上長と営業担当者のコミュニケーション促進
3. 営業活動データの蓄積と分析基盤の構築
4. 日報作成業務の効率化

### 背景

- 従来は紙やExcelで日報を管理しており、検索性や共有性に課題があった
- 営業活動の履歴が体系的に管理されていなかった
- 上長からのフィードバックが遅延したり、記録に残らないことがあった

### 期待される効果

- 日報作成時間の短縮（30%削減目標）
- 営業活動の透明性向上
- ナレッジの蓄積と共有
- PDCAサイクルの高速化

---

## 主要機能

### 1. 日報作成機能

営業担当者が日々の営業活動を記録する

**主な内容:**

- 日報の新規作成
- 訪問記録の登録（複数件）
- 課題・相談事項（Problem）の記載
- 翌日の予定（Plan）の記載

### 2. 日報閲覧機能

作成した日報を閲覧・検索する

**主な内容:**

- 日報一覧表示
- 検索・フィルタリング（営業担当者、日付範囲）
- 日報詳細表示

### 3. 訪問記録管理機能

顧客への訪問履歴を記録する

**主な内容:**

- 訪問先顧客の選択（顧客マスタから）
- 訪問時刻の記録
- 訪問内容の記載
- 訪問記録の追加・編集・削除

### 4. コメント機能

上長が日報に対してフィードバックを行う

**主な内容:**

- コメントの追加
- コメント履歴の表示
- コメントの編集・削除

### 5. 顧客マスタ管理機能

訪問先顧客の情報を管理する

**主な内容:**

- 顧客情報の登録・編集・削除
- 顧客一覧の表示・検索

### 6. 営業マスタ管理機能

営業担当者の情報を管理する

**主な内容:**

- 営業担当者情報の登録・編集・削除
- 営業担当者一覧の表示・検索
- 認証情報の管理

---

## 機能要件

### FR-001: ログイン機能

**優先度**: 高  
**説明**: ユーザーがシステムにログインできる

**詳細要件:**

- メールアドレスとパスワードによる認証
- JWT（JSON Web Token）による認証状態の保持
- トークンの有効期限管理（24時間）
- ログアウト機能

**入力:**

- メールアドレス
- パスワード

**出力:**

- 認証トークン
- ユーザー情報（名前、権限など）

---

### FR-002: 日報作成機能

**優先度**: 高  
**説明**: 営業担当者が日報を作成できる

**詳細要件:**

- 1日1件の日報を作成可能
- 同一日付での重複作成は不可
- 訪問記録は1件以上必須
- 課題・予定は任意入力

**入力:**

- 日報日付（必須）
- 訪問記録（1件以上必須）
  - 顧客ID（必須）
  - 訪問時刻（任意）
  - 訪問内容（必須、最大1000文字）
- 課題・相談（任意、最大2000文字）
- 明日の予定（任意、最大2000文字）

**出力:**

- 日報ID
- 作成日時

**バリデーション:**

- 日報日付が未来日でないこと
- 訪問記録が1件以上あること
- 顧客IDが存在すること
- 文字数制限を超えないこと

---

### FR-003: 日報編集機能

**優先度**: 高  
**説明**: 作成した日報を編集できる

**詳細要件:**

- 本人のみ編集可能
- 訪問記録の追加・削除が可能
- 既存の訪問記録の更新が可能

**入力:**

- 日報ID
- 更新内容（FR-002と同様）

**出力:**

- 更新日時

**制約:**

- 他人の日報は編集不可（403エラー）

---

### FR-004: 日報削除機能

**優先度**: 中  
**説明**: 作成した日報を削除できる

**詳細要件:**

- 本人のみ削除可能
- 論理削除または物理削除（設計時に決定）

**入力:**

- 日報ID

**出力:**

- 削除成功メッセージ

**制約:**

- 他人の日報は削除不可（403エラー）

---

### FR-005: 日報一覧表示機能

**優先度**: 高  
**説明**: 日報の一覧を表示できる

**詳細要件:**

- 営業担当者は自分の日報のみ表示
- 上長は配下メンバーの日報を表示
- 管理者は全員の日報を表示
- ページネーション対応（1ページ20件）

**入力（検索条件）:**

- 営業担当者ID（任意）
- 日報日付（開始）（任意）
- 日報日付（終了）（任意）
- ページ番号（デフォルト: 1）

**出力:**

- 日報一覧
  - 日報ID
  - 日報日付
  - 営業担当者名
  - 訪問件数
  - コメント数
  - 登録日時

---

### FR-006: 日報詳細表示機能

**優先度**: 高  
**説明**: 日報の詳細情報を表示できる

**詳細要件:**

- 基本情報、訪問記録、コメントを全て表示
- 閲覧権限のチェック

**入力:**

- 日報ID

**出力:**

- 日報詳細情報
  - 基本情報（日付、担当者、課題、予定）
  - 訪問記録一覧
  - コメント一覧

---

### FR-007: コメント追加機能

**優先度**: 高  
**説明**: 上長が日報にコメントを追加できる

**詳細要件:**

- 上長権限を持つユーザーのみ実行可能
- コメントは複数件追加可能

**入力:**

- 日報ID
- コメント内容（必須、最大1000文字）

**出力:**

- コメントID
- コメント日時

**制約:**

- 一般営業担当者はコメント追加不可（403エラー）

---

### FR-008: コメント編集・削除機能

**優先度**: 中  
**説明**: 投稿したコメントを編集・削除できる

**詳細要件:**

- コメント投稿者のみ編集・削除可能

**入力:**

- コメントID
- 更新内容（編集の場合）

**出力:**

- 更新日時（編集の場合）
- 削除成功メッセージ（削除の場合）

---

### FR-009: 顧客マスタ管理機能

**優先度**: 高  
**説明**: 顧客情報を管理できる

**詳細要件:**

- 全ユーザーが参照可能
- 管理者のみ登録・更新・削除可能

**入力（登録・更新）:**

- 顧客名（必須、最大100文字）
- 会社名（必須、最大200文字）
- 電話番号（任意）
- メールアドレス（任意、メール形式）
- 住所（任意、最大500文字）

**出力:**

- 顧客ID
- 登録・更新日時

**制約:**

- 訪問記録に紐づいている顧客は削除不可（409エラー）

---

### FR-010: 顧客検索機能

**優先度**: 中  
**説明**: 顧客を検索できる

**詳細要件:**

- 顧客名、会社名で部分一致検索
- ページネーション対応

**入力:**

- 顧客名（任意）
- 会社名（任意）
- ページ番号

**出力:**

- 顧客一覧

---

### FR-011: 営業マスタ管理機能

**優先度**: 高  
**説明**: 営業担当者情報を管理できる

**詳細要件:**

- 管理者のみ実行可能
- パスワードはハッシュ化して保存

**入力（登録・更新）:**

- 営業担当者名（必須、最大100文字）
- メールアドレス（必須、メール形式、一意）
- パスワード（登録時必須、8文字以上）
- 部署（必須）
- 役職（必須）

**出力:**

- 営業担当者ID
- 登録・更新日時

**制約:**

- メールアドレスは重複不可（409エラー）
- 日報・コメントに紐づいている営業担当者は削除不可（409エラー）

---

### FR-012: 営業担当者検索機能

**優先度**: 中  
**説明**: 営業担当者を検索できる

**詳細要件:**

- 管理者のみ実行可能
- 営業担当者名、部署で検索

**入力:**

- 営業担当者名（任意）
- 部署（任意）
- ページ番号

**出力:**

- 営業担当者一覧

---

## 非機能要件

### NFR-001: パフォーマンス

**優先度**: 高

**要件:**

- APIレスポンスタイム
  - 単純な取得系API: 1秒以内（95パーセンタイル）
  - 更新系API: 2秒以内（95パーセンタイル）
- 画面表示時間
  - 初期表示: 3秒以内
  - 画面遷移: 1秒以内
- 同時接続ユーザー数
  - 通常時: 50ユーザー
  - ピーク時: 100ユーザー

---

### NFR-002: セキュリティ

**優先度**: 高

**要件:**

- 認証・認可
  - JWT認証の実装
  - パスワードのハッシュ化（bcrypt使用）
  - トークンの有効期限管理
- データ保護
  - HTTPS通信の強制
  - SQLインジェクション対策
  - XSS（クロスサイトスクリプティング）対策
  - CSRF（クロスサイトリクエストフォージェリ）対策
- アクセス制御
  - ロールベースアクセス制御（RBAC）
  - リソースレベルでの権限チェック

---

### NFR-003: 可用性

**優先度**: 中

**要件:**

- 稼働率: 99%以上（月間）
- バックアップ
  - 日次バックアップの実施
  - バックアップデータの保持期間: 30日
  - リストア時間: 1時間以内

---

### NFR-004: 保守性

**優先度**: 中

**要件:**

- コードの可読性
  - コーディング規約の遵守
  - 適切なコメント
- ログ管理
  - アクセスログの記録
  - エラーログの記録
  - ログの保持期間: 90日
- モニタリング
  - システムリソースの監視
  - エラー率の監視
  - レスポンスタイムの監視

---

### NFR-005: ユーザビリティ

**優先度**: 高

**要件:**

- レスポンシブデザイン対応
  - PC、タブレット、スマートフォンで利用可能
- ブラウザ対応
  - Chrome（最新版）
  - Edge（最新版）
  - Safari（最新版）
  - Firefox（最新版）
- アクセシビリティ
  - WCAG 2.1 レベルAA準拠を目指す
  - キーボード操作対応
- 多言語対応
  - 初期リリース: 日本語のみ
  - 将来的に英語対応を検討

---

### NFR-006: 拡張性

**優先度**: 中

**要件:**

- マイクロサービス化を想定した設計
- API駆動のアーキテクチャ
- データベースのスケーラビリティ
  - 読み取りレプリカの追加が可能
  - シャーディング対応可能な設計

---

### NFR-007: 互換性

**優先度**: 低

**要件:**

- 外部システムとの連携
  - REST API経由でのデータ連携が可能
  - CSV/Excelエクスポート機能（将来対応）
- データ移行
  - 既存のExcelデータからのインポート機能（将来対応）

---

## システム構成

### アーキテクチャ

3層アーキテクチャを採用

```
┌─────────────────┐
│  プレゼンテーション層  │  (Web UI)
├─────────────────┤
│  アプリケーション層   │  (API Server)
├─────────────────┤
│   データ層       │  (Database)
└─────────────────┘
```

### 技術スタック（推奨）

**フロントエンド:**

- React 18+ / Vue 3+ / Next.js 14+
- TypeScript
- Tailwind CSS / Material-UI
- Axios / Fetch API

**バックエンド:**

- Node.js (Express) / Python (FastAPI/Django) / Go (Gin)
- TypeScript / Python / Go
- JWT認証

**データベース:**

- PostgreSQL 15+ / MySQL 8.0+

**インフラ:**

- Docker / Docker Compose
- Nginx（リバースプロキシ）
- AWS / GCP / Azure（クラウド環境）

---

## ユーザー種別と権限

### ユーザー種別

#### 1. 営業担当者（一般）

**権限:**

- 自分の日報の作成・編集・削除
- 自分の日報の閲覧
- 顧客マスタの参照

**制限:**

- 他人の日報の編集・削除不可
- コメント追加不可
- マスタデータの編集不可

---

#### 2. 上長（課長、部長など）

**権限:**

- 自分の日報の作成・編集・削除
- 配下メンバーの日報の閲覧
- 日報へのコメント追加・編集・削除
- 顧客マスタの参照

**制限:**

- 他部署の日報は閲覧不可（権限による）
- マスタデータの編集不可

---

#### 3. システム管理者

**権限:**

- 全ての日報の閲覧
- 顧客マスタの登録・編集・削除
- 営業マスタの登録・編集・削除
- システム設定の変更

---

## エンティティ定義

### Sales（営業担当者）

営業担当者の基本情報を管理

**属性:**

- sales_id（営業ID）: 主キー、自動採番
- sales_name（営業担当者名）: 必須、最大100文字
- email（メールアドレス）: 必須、一意、ログインIDとして使用
- password（パスワード）: 必須、ハッシュ化して保存
- department（部署）: 必須
- position（役職）: 必須
- created_at（登録日時）: 自動設定
- updated_at（更新日時）: 自動更新

---

### Customer（顧客）

営業先顧客の基本情報を管理

**属性:**

- customer_id（顧客ID）: 主キー、自動採番
- customer_name（顧客名）: 必須、最大100文字
- company_name（会社名）: 必須、最大200文字
- phone（電話番号）: 任意
- email（メールアドレス）: 任意
- address（住所）: 任意、最大500文字
- created_at（登録日時）: 自動設定
- updated_at（更新日時）: 自動更新

---

### DailyReport（日報）

営業担当者が作成する日次レポート

**属性:**

- report_id（日報ID）: 主キー、自動採番
- sales_id（営業ID）: 外部キー（Sales）、必須
- report_date（日報日付）: 必須、ユニーク制約（sales_id + report_date）
- problem（課題・相談）: 任意、最大2000文字
- plan（明日の予定）: 任意、最大2000文字
- created_at（登録日時）: 自動設定
- updated_at（更新日時）: 自動更新

**制約:**

- sales_id + report_dateでユニーク（1営業担当者につき1日1件）

---

### VisitRecord（訪問記録）

1日の訪問先と訪問内容を記録

**属性:**

- visit_id（訪問記録ID）: 主キー、自動採番
- report_id（日報ID）: 外部キー（DailyReport）、必須
- customer_id（顧客ID）: 外部キー（Customer）、必須
- visit_time（訪問時刻）: 任意、HH:MM形式
- visit_content（訪問内容）: 必須、最大1000文字
- created_at（登録日時）: 自動設定
- updated_at（更新日時）: 自動更新

**制約:**

- 日報に必ず紐づく（report_idは必須）

---

### Comment（コメント）

上長が日報に対して記載するフィードバック

**属性:**

- comment_id（コメントID）: 主キー、自動採番
- report_id（日報ID）: 外部キー（DailyReport）、必須
- sales_id（コメント者ID）: 外部キー（Sales）、必須
- comment_content（コメント内容）: 必須、最大1000文字
- created_at（コメント日時）: 自動設定
- updated_at（更新日時）: 自動更新

**制約:**

- 日報に必ず紐づく（report_idは必須）

---

## 制約事項

### データ制約

1. **日報の一意性**
   - 1営業担当者につき1日1件の日報のみ作成可能
   - sales_id + report_dateでユニーク制約

2. **訪問記録の必須性**
   - 日報には最低1件の訪問記録が必要

3. **外部キー制約**
   - 訪問記録に紐づく顧客は削除不可
   - 日報・コメントに紐づく営業担当者は削除不可

4. **文字数制限**
   - 各項目に最大文字数制限あり（詳細はエンティティ定義参照）

### ビジネスルール

1. **権限による制限**
   - 営業担当者は自分の日報のみ編集可能
   - コメント追加は上長権限が必要

2. **日付の制限**
   - 未来日の日報は作成不可

### 技術的制約

1. **ブラウザサポート**
   - 最新版のモダンブラウザのみサポート
   - IE11はサポート対象外

2. **同時接続数**
   - 最大100ユーザーまで

---

## 今後の拡張性

### Phase 2（将来的な拡張）

1. **承認ワークフロー**
   - 日報の承認・却下機能
   - 承認フローのカスタマイズ

2. **レポート・分析機能**
   - 訪問件数の集計
   - 営業活動のダッシュボード
   - 月次・四半期レポート

3. **通知機能**
   - コメント追加時の通知（メール・プッシュ通知）
   - 日報未提出のリマインダー

4. **モバイルアプリ**
   - iOS/Androidネイティブアプリ
   - オフライン対応

5. **外部連携**
   - カレンダー連携（Google Calendar、Outlook）
   - SFA/CRMシステムとの連携
   - Slack/Teams通知

6. **AI活用**
   - 訪問内容の自動要約
   - 次回提案内容のレコメンド

7. **データエクスポート**
   - CSV/Excelエクスポート
   - PDFレポート生成

---

## 改訂履歴

| 版数 | 改訂日     | 改訂者 | 改訂内容 |
| ---- | ---------- | ------ | -------- |
| 1.0  | 2026/01/02 | -      | 初版作成 |
